<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="The `edition_2024_expr_fragment_specifier` lint detects the use of `expr` fragments in macros during migration to the 2024 edition."><title>EDITION_2024_EXPR_FRAGMENT_SPECIFIER in rustc_lint::macro_expr_fragment_specifier_2024_migration - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-46f98efaafac5295.ttf.woff2,FiraSans-Regular-018c141bf0843ffd.woff2,FiraSans-Medium-8f9a781e4970d388.woff2,SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2,SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-5ca6ca2a1f83705a.css"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="rustc_lint" data-themes="" data-resource-suffix="" data-rustdoc-version="1.82.0-dev" data-channel="nightly" data-search-js="search-d234aafac6c221dd.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../../static.files/storage-118b08c4c78b968e.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../static.files/main-d2fab2bf619172d3.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-df360f571f6edeae.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc static"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button><a class="logo-container" href="../../rustc_lint/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt=""></a></nav><nav class="sidebar"><div class="sidebar-crate"><a class="logo-container" href="../../rustc_lint/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2><a href="../../rustc_lint/index.html">rustc_lint</a><span class="version">1.82.0-dev</span></h2></div><div class="sidebar-elems"><h2><a href="index.html">In rustc_lint::macro_expr_fragment_specifier_2024_migration</a></h2></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><h1>Static <a href="../index.html">rustc_lint</a>::<wbr><a href="index.html">macro_expr_fragment_specifier_2024_migration</a>::<wbr><a class="static" href="#">EDITION_2024_EXPR_FRAGMENT_SPECIFIER</a><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><span class="out-of-band"><a class="src" href="../../src/rustc_lint/macro_expr_fragment_specifier_2024_migration.rs.html#18-82">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><pre class="rust item-decl"><code>pub static EDITION_2024_EXPR_FRAGMENT_SPECIFIER: &amp;<a class="struct" href="../struct.Lint.html" title="struct rustc_lint::Lint">Lint</a></code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>The <code>edition_2024_expr_fragment_specifier</code> lint detects the use of
<code>expr</code> fragments in macros during migration to the 2024 edition.</p>
<p>The <code>expr</code> fragment specifier will accept more expressions in the 2024
edition. To maintain the behavior from the 2021 edition and earlier, use
the <code>expr_2021</code> fragment specifier.</p>
<h4 id="example"><a class="doc-anchor" href="#example">§</a>Example</h4>
<div class="example-wrap compile_fail"><a href="#" class="tooltip" title="This example deliberately fails to compile">ⓘ</a><pre class="rust rust-example-rendered"><code><span class="attr">#![deny(edition_2024_expr_fragment_specifier)]
</span><span class="macro">macro_rules!</span> m {
  (<span class="macro-nonterminal">$e</span>:expr) =&gt; {
      <span class="macro-nonterminal">$e
  </span>}
}

<span class="kw">fn </span>main() {
   <span class="macro">m!</span>(<span class="number">1</span>);
}</code></pre></div>
<p>{{produces}}</p>
<h4 id="explanation"><a class="doc-anchor" href="#explanation">§</a>Explanation</h4>
<p>Rust <a href="https://doc.rust-lang.org/edition-guide/">editions</a> allow the language to evolve without breaking backwards
compatibility. This lint catches code that uses <a href="https://doc.rust-lang.org/nightly/edition-guide/rust-2024/macro-fragment-specifiers.html">macro matcher fragment
specifiers</a> that have changed meaning in the 2024 edition. If you switch
to the new edition without updating the code, your macros may behave
differently.</p>
<p>In the 2024 edition, the <code>expr</code> fragment specifier <code>expr</code> will also
match <code>const { ... }</code> blocks. This means if a macro had a pattern that
matched <code>$e:expr</code> and another that matches <code>const { $e: expr }</code>, for
example, that under the 2024 edition the first pattern would match while
in the 2021 and earlier editions the second pattern would match. To keep
the old behavior, use the <code>expr_2021</code> fragment specifier.</p>
<p>This lint detects macros whose behavior might change due to the changing
meaning of the <code>expr</code> fragment specifier. It is “allow” by default
because the code is perfectly valid in older editions. The <a href="https://doc.rust-lang.org/cargo/commands/cargo-fix.html"><code>cargo fix</code></a>
tool with the <code>--edition</code> flag will switch this lint to “warn” and
automatically apply the suggested fix from the compiler. This provides a
completely automated way to update old code for a new edition.</p>
<p>Using <code>cargo fix --edition</code> with this lint will ensure that your code
retains the same behavior. This may not be the desired, as macro authors
often will want their macros to use the latest grammar for matching
expressions. Be sure to carefully review changes introduced by this lint
to ensure the macros implement the desired behavior.</p>
</div></details></section></div></main></body></html>