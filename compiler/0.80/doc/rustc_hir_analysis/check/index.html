<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="typeck: check phase"><title>rustc_hir_analysis::check - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-46f98efaafac5295.ttf.woff2,FiraSans-Regular-018c141bf0843ffd.woff2,FiraSans-Medium-8f9a781e4970d388.woff2,SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2,SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-5ca6ca2a1f83705a.css"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="rustc_hir_analysis" data-themes="" data-resource-suffix="" data-rustdoc-version="1.82.0-dev" data-channel="nightly" data-search-js="search-d234aafac6c221dd.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../../static.files/storage-118b08c4c78b968e.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../static.files/main-d2fab2bf619172d3.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-df360f571f6edeae.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button><a class="logo-container" href="../../rustc_hir_analysis/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt=""></a></nav><nav class="sidebar"><div class="sidebar-crate"><a class="logo-container" href="../../rustc_hir_analysis/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2><a href="../../rustc_hir_analysis/index.html">rustc_hir_analysis</a><span class="version">1.82.0-dev</span></h2></div><h2 class="location"><a href="#">Module check</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#modules">Modules</a></li><li><a href="#functions">Functions</a></li></ul></section><h2><a href="../index.html">In crate rustc_hir_analysis</a></h2></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><h1>Module <a href="../index.html">rustc_hir_analysis</a>::<wbr><a class="mod" href="#">check</a><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><span class="out-of-band"><a class="src" href="../../src/rustc_hir_analysis/check/mod.rs.html#1-673">source</a> Â· <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><h2 id="typeck-check-phase"><a class="doc-anchor" href="#typeck-check-phase">Â§</a>typeck: check phase</h2>
<p>Within the check phase of type check, we check each item one at a time
(bodies of function expressions are checked as part of the containing
function). Inference is used to supply types wherever they are unknown.</p>
<p>By far the most complex case is checking the body of a function. This
can be broken down into several distinct phases:</p>
<ul>
<li>
<p>gather: creates type variables to represent the type of each local
variable and pattern binding.</p>
</li>
<li>
<p>main: the main pass does the lionâ€™s share of the work: it
determines the types of all expressions, resolves
methods, checks for most invalid conditions, and so forth. In
some cases, where a type is unknown, it may create a type or region
variable and use that as the type of an expression.</p>
<p>In the process of checking, various constraints will be placed on
these type variables through the subtyping relationships requested
through the <code>demand</code> module. The <code>infer</code> module is in charge
of resolving those constraints.</p>
</li>
<li>
<p>regionck: after main is complete, the regionck pass goes over all
types looking for regions and making sure that they did not escape
into places where they are not in scope. This may also influence the
final assignments of the various region variables if there is some
flexibility.</p>
</li>
<li>
<p>writeback: writes the final types within a function body, replacing
type variables with their final inferred types. These final types
are written into the <code>tcx.node_types</code> table, which should <em>never</em> contain
any reference to a type variable.</p>
</li>
</ul>
<h3 id="intermediate-types"><a class="doc-anchor" href="#intermediate-types">Â§</a>Intermediate types</h3>
<p>While type checking a function, the intermediate types for the
expressions, blocks, and so forth contained within the function are
stored in <code>fcx.node_types</code> and <code>fcx.node_args</code>. These types
may contain unresolved type variables. After type checking is
complete, the functions in the writeback module are used to take the
types from this table, resolve them, and then write them into their
permanent home in the type context <code>tcx</code>.</p>
<p>This means that during inferencing you should use <code>fcx.write_ty()</code>
and <code>fcx.expr_ty()</code> / <code>fcx.node_ty()</code> to write/obtain the types of
nodes within the function.</p>
<p>The types of top-level items, which never contain unbound type
variables, are stored directly into the <code>tcx</code> typeck_results.</p>
<p>N.B., a type variable is not the same thing as a type parameter. A
type variable is an instance of a type parameter. That is,
given a generic function <code>fn foo&lt;T&gt;(t: T)</code>, while checking the
function <code>foo</code>, the type <code>ty_param(0)</code> refers to the type <code>T</code>, which
is treated in abstract. However, when <code>foo()</code> is called, <code>T</code> will be
instantiated with a fresh type variable <code>N</code>. This variable will
eventually be resolved to some concrete type (which might itself be
a type parameter).</p>
</div></details><h2 id="modules" class="section-header">Modules<a href="#modules" class="anchor">Â§</a></h2><ul class="item-table"><li><div class="item-name"><a class="mod" href="check/index.html" title="mod rustc_hir_analysis::check::check">check</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div></li><li><div class="item-name"><a class="mod" href="compare_impl_item/index.html" title="mod rustc_hir_analysis::check::compare_impl_item">compare_impl_item</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div></li><li><div class="item-name"><a class="mod" href="dropck/index.html" title="mod rustc_hir_analysis::check::dropck">dropck</a></div></li><li><div class="item-name"><a class="mod" href="entry/index.html" title="mod rustc_hir_analysis::check::entry">entry</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div></li><li><div class="item-name"><a class="mod" href="errs/index.html" title="mod rustc_hir_analysis::check::errs">errs</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div></li><li><div class="item-name"><a class="mod" href="intrinsic/index.html" title="mod rustc_hir_analysis::check::intrinsic">intrinsic</a></div><div class="desc docblock-short">Type-checking for the rust-intrinsic and platform-intrinsic
intrinsics that the compiler exposes.</div></li><li><div class="item-name"><a class="mod" href="intrinsicck/index.html" title="mod rustc_hir_analysis::check::intrinsicck">intrinsicck</a></div></li><li><div class="item-name"><a class="mod" href="region/index.html" title="mod rustc_hir_analysis::check::region">region</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div><div class="desc docblock-short">This file builds up the <code>ScopeTree</code>, which describes
the parent links in the region hierarchy.</div></li><li><div class="item-name"><a class="mod" href="wfcheck/index.html" title="mod rustc_hir_analysis::check::wfcheck">wfcheck</a></div></li></ul><h2 id="functions" class="section-header">Functions<a href="#functions" class="anchor">Â§</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.adt_async_destructor.html" title="fn rustc_hir_analysis::check::adt_async_destructor">adt_async_destructor</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div></li><li><div class="item-name"><a class="fn" href="fn.adt_destructor.html" title="fn rustc_hir_analysis::check::adt_destructor">adt_destructor</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div></li><li><div class="item-name"><a class="fn" href="fn.bad_non_zero_sized_fields.html" title="fn rustc_hir_analysis::check::bad_non_zero_sized_fields">bad_non_zero_sized_fields</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div><div class="desc docblock-short">Emit an error when encountering two or more non-zero-sized fields in a transparent
enum.</div></li><li><div class="item-name"><a class="fn" href="fn.bad_variant_count.html" title="fn rustc_hir_analysis::check::bad_variant_count">bad_variant_count</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div><div class="desc docblock-short">Emit an error when encountering two or more variants in a transparent enum.</div></li><li><div class="item-name"><a class="fn" href="fn.bounds_from_generic_predicates.html" title="fn rustc_hir_analysis::check::bounds_from_generic_predicates">bounds_from_generic_predicates</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div><div class="desc docblock-short">Re-sugar <code>ty::GenericPredicates</code> in a way suitable to be used in structured suggestions.</div></li><li><div class="item-name"><a class="fn" href="fn.check_abi.html" title="fn rustc_hir_analysis::check::check_abi">check_abi</a></div></li><li><div class="item-name"><a class="fn" href="fn.check_function_signature.html" title="fn rustc_hir_analysis::check::check_function_signature">check_function_signature</a></div></li><li><div class="item-name"><a class="fn" href="fn.default_body_is_unstable.html" title="fn rustc_hir_analysis::check::default_body_is_unstable">default_body_is_unstable</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div></li><li><div class="item-name"><a class="fn" href="fn.fn_sig_suggestion.html" title="fn rustc_hir_analysis::check::fn_sig_suggestion">fn_sig_suggestion</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div><div class="desc docblock-short">Return placeholder code for the given function.</div></li><li><div class="item-name"><a class="fn" href="fn.forbid_intrinsic_abi.html" title="fn rustc_hir_analysis::check::forbid_intrinsic_abi">forbid_intrinsic_abi</a></div><div class="desc docblock-short">Forbid defining intrinsics in Rust code,
as they must always be defined by the compiler.</div></li><li><div class="item-name"><a class="fn" href="fn.get_owner_return_paths.html" title="fn rustc_hir_analysis::check::get_owner_return_paths">get_owner_return_paths</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div><div class="desc docblock-short">Given a <code>DefId</code> for an opaque type in return position, find its parent itemâ€™s return
expressions.</div></li><li><div class="item-name"><a class="fn" href="fn.maybe_check_static_with_link_section.html" title="fn rustc_hir_analysis::check::maybe_check_static_with_link_section">maybe_check_static_with_link_section</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div></li><li><div class="item-name"><a class="fn" href="fn.missing_items_err.html" title="fn rustc_hir_analysis::check::missing_items_err">missing_items_err</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div></li><li><div class="item-name"><a class="fn" href="fn.missing_items_must_implement_one_of_err.html" title="fn rustc_hir_analysis::check::missing_items_must_implement_one_of_err">missing_items_must_implement_one_of_err</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div></li><li><div class="item-name"><a class="fn" href="fn.potentially_plural_count.html" title="fn rustc_hir_analysis::check::potentially_plural_count">potentially_plural_count</a></div></li><li><div class="item-name"><a class="fn" href="fn.provide.html" title="fn rustc_hir_analysis::check::provide">provide</a></div></li><li><div class="item-name"><a class="fn" href="fn.report_forbidden_specialization.html" title="fn rustc_hir_analysis::check::report_forbidden_specialization">report_forbidden_specialization</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div></li><li><div class="item-name"><a class="fn" href="fn.suggestion_signature.html" title="fn rustc_hir_analysis::check::suggestion_signature">suggestion_signature</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div><div class="desc docblock-short">Return placeholder code for the given associated item.
Similar to <code>ty::AssocItem::suggestion</code>, but appropriate for use as the code snippet of a
structured suggestion.</div></li></ul></section></div></main></body></html>