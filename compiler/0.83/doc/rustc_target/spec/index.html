<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Flexible target specification."><title>rustc_target::spec - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-46f98efaafac5295.ttf.woff2,FiraSans-Regular-018c141bf0843ffd.woff2,FiraSans-Medium-8f9a781e4970d388.woff2,SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2,SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-49344e4802b2d48a.css"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="rustc_target" data-themes="" data-resource-suffix="" data-rustdoc-version="1.83.0-dev" data-channel="nightly" data-search-js="search-e056c65ede92db13.js" data-settings-js="settings-805db61a62df4bd2.js" ><script src="../../static.files/storage-1d39b6787ed640ff.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../static.files/main-f070b9041d14864c.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-0111fcff984fae8f.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button><a class="logo-container" href="../../rustc_target/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt=""></a></nav><nav class="sidebar"><div class="sidebar-crate"><a class="logo-container" href="../../rustc_target/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2><a href="../../rustc_target/index.html">rustc_<wbr>target</a><span class="version">1.83.0-dev</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Module spec</a></h2><h3><a href="#">Sections</a></h3><ul class="block top-toc"><li><a href="#using-custom-targets" title="Using custom targets">Using custom targets</a></li><li><a href="#defining-a-new-target" title="Defining a new target">Defining a new target</a></li></ul><h3><a href="#modules">Module Items</a></h3><ul class="block"><li><a href="#modules" title="Modules">Modules</a></li><li><a href="#macros" title="Macros">Macros</a></li><li><a href="#structs" title="Structs">Structs</a></li><li><a href="#enums" title="Enums">Enums</a></li><li><a href="#constants" title="Constants">Constants</a></li><li><a href="#traits" title="Traits">Traits</a></li><li><a href="#functions" title="Functions">Functions</a></li><li><a href="#types" title="Type Aliases">Type Aliases</a></li></ul></section><div id="rustdoc-modnav"><h2 class="in-crate"><a href="../index.html">In crate rustc_<wbr>target</a></h2></div></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><span class="rustdoc-breadcrumbs"><a href="../index.html">rustc_target</a></span><h1>Module <span>spec</span><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../src/rustc_target/spec/mod.rs.html#1-3862">source</a> </span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p><a href="https://github.com/rust-lang/rfcs/pull/131">Flexible target specification.</a></p>
<p>Rust targets a wide variety of usecases, and in the interest of flexibility,
allows new target triples to be defined in configuration files. Most users
will not need to care about these, but this is invaluable when porting Rust
to a new platform, and allows for an unprecedented level of control over how
the compiler works.</p>
<h2 id="using-custom-targets"><a class="doc-anchor" href="#using-custom-targets">§</a>Using custom targets</h2>
<p>A target triple, as passed via <code>rustc --target=TRIPLE</code>, will first be
compared against the list of built-in targets. This is to ease distributing
rustc (no need for configuration files) and also to hold these built-in
targets as immutable and sacred. If <code>TRIPLE</code> is not one of the built-in
targets, rustc will check if a file named <code>TRIPLE</code> exists. If it does, it
will be loaded as the target configuration. If the file does not exist,
rustc will search each directory in the environment variable
<code>RUST_TARGET_PATH</code> for a file named <code>TRIPLE.json</code>. The first one found will
be loaded. If no file is found in any of those directories, a fatal error
will be given.</p>
<p>Projects defining their own targets should use
<code>--target=path/to/my-awesome-platform.json</code> instead of adding to
<code>RUST_TARGET_PATH</code>.</p>
<h2 id="defining-a-new-target"><a class="doc-anchor" href="#defining-a-new-target">§</a>Defining a new target</h2>
<p>Targets are defined using <a href="https://json.org/">JSON</a>. The <code>Target</code> struct in
this module defines the format the JSON file should take, though each
underscore in the field names should be replaced with a hyphen (<code>-</code>) in the
JSON file. Some fields are required in every target specification, such as
<code>llvm-target</code>, <code>target-endian</code>, <code>target-pointer-width</code>, <code>data-layout</code>,
<code>arch</code>, and <code>os</code>. In general, options passed to rustc with <code>-C</code> override
the target’s settings, though <code>target-feature</code> and <code>link-args</code> will <em>add</em>
to the list specified by the target, rather than replace.</p>
</div></details><h2 id="modules" class="section-header">Modules<a href="#modules" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="mod" href="abi/index.html" title="mod rustc_target::spec::abi">abi</a></div></li><li><div class="item-name"><a class="mod" href="base/index.html" title="mod rustc_target::spec::base">base</a><span title="Restricted Visibility">&nbsp;🔒</span> </div></li><li><div class="item-name"><a class="mod" href="crt_objects/index.html" title="mod rustc_target::spec::crt_objects">crt_<wbr>objects</a></div><div class="desc docblock-short">Object files providing support for basic runtime facilities and added to the produced binaries
at the start and at the end of linking.</div></li><li><div class="item-name"><a class="mod" href="targets/index.html" title="mod rustc_target::spec::targets">targets</a><span title="Restricted Visibility">&nbsp;🔒</span> </div></li></ul><h2 id="macros" class="section-header">Macros<a href="#macros" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="macro" href="macro.cvs.html" title="macro rustc_target::spec::cvs">cvs</a><span title="Restricted Visibility">&nbsp;🔒</span> </div><div class="desc docblock-short">Cow-Vec-Str: Cow&lt;’static, [Cow&lt;’static, str&gt;]&gt;</div></li><li><div class="item-name"><a class="macro" href="macro.linker_flavor_cli_impls.html" title="macro rustc_target::spec::linker_flavor_cli_impls">linker_<wbr>flavor_<wbr>cli_<wbr>impls</a><span title="Restricted Visibility">&nbsp;🔒</span> </div></li><li><div class="item-name"><a class="macro" href="macro.supported_targets.html" title="macro rustc_target::spec::supported_targets">supported_<wbr>targets</a><span title="Restricted Visibility">&nbsp;🔒</span> </div></li></ul><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.LinkSelfContainedComponents.html" title="struct rustc_target::spec::LinkSelfContainedComponents">Link<wbr>Self<wbr>Contained<wbr>Components</a></div><div class="desc docblock-short">The <code>-C link-self-contained</code> components that can individually be enabled or disabled.</div></li><li><div class="item-name"><a class="struct" href="struct.LinkerFeatures.html" title="struct rustc_target::spec::LinkerFeatures">Linker<wbr>Features</a></div><div class="desc docblock-short">The <code>-Z linker-features</code> components that can individually be enabled or disabled.</div></li><li><div class="item-name"><a class="struct" href="struct.SanitizerSet.html" title="struct rustc_target::spec::SanitizerSet">Sanitizer<wbr>Set</a></div></li><li><div class="item-name"><a class="struct" href="struct.Target.html" title="struct rustc_target::spec::Target">Target</a></div><div class="desc docblock-short">Everything <code>rustc</code> knows about how to compile for a specific target.</div></li><li><div class="item-name"><a class="struct" href="struct.TargetMetadata.html" title="struct rustc_target::spec::TargetMetadata">Target<wbr>Metadata</a></div><div class="desc docblock-short">Metadata about a target like the description or tier.
Part of #120745.
All fields are optional for now, but intended to be required in the future.</div></li><li><div class="item-name"><a class="struct" href="struct.TargetOptions.html" title="struct rustc_target::spec::TargetOptions">Target<wbr>Options</a></div><div class="desc docblock-short">Optional aspects of a target specification.</div></li><li><div class="item-name"><a class="struct" href="struct.TargetWarnings.html" title="struct rustc_target::spec::TargetWarnings">Target<wbr>Warnings</a></div><div class="desc docblock-short">Warnings encountered when parsing the target <code>json</code>.</div></li></ul><h2 id="enums" class="section-header">Enums<a href="#enums" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="enum" href="enum.Cc.html" title="enum rustc_target::spec::Cc">Cc</a></div><div class="desc docblock-short">Linker is called through a C/C++ compiler.</div></li><li><div class="item-name"><a class="enum" href="enum.CodeModel.html" title="enum rustc_target::spec::CodeModel">Code<wbr>Model</a></div></li><li><div class="item-name"><a class="enum" href="enum.DebuginfoKind.html" title="enum rustc_target::spec::DebuginfoKind">Debuginfo<wbr>Kind</a></div><div class="desc docblock-short">Which kind of debuginfo does the target use?</div></li><li><div class="item-name"><a class="enum" href="enum.FramePointer.html" title="enum rustc_target::spec::FramePointer">Frame<wbr>Pointer</a></div></li><li><div class="item-name"><a class="enum" href="enum.LinkOutputKind.html" title="enum rustc_target::spec::LinkOutputKind">Link<wbr>Output<wbr>Kind</a></div><div class="desc docblock-short">Everything is flattened to a single enum to make the json encoding/decoding less annoying.</div></li><li><div class="item-name"><a class="enum" href="enum.LinkSelfContainedDefault.html" title="enum rustc_target::spec::LinkSelfContainedDefault">Link<wbr>Self<wbr>Contained<wbr>Default</a></div><div class="desc docblock-short">The different <code>-Clink-self-contained</code> options that can be specified in a target spec:</div></li><li><div class="item-name"><a class="enum" href="enum.LinkerFlavor.html" title="enum rustc_target::spec::LinkerFlavor">Linker<wbr>Flavor</a></div><div class="desc docblock-short">All linkers have some kinds of command line interfaces and rustc needs to know which commands
to use with each of them. So we cluster all such interfaces into a (somewhat arbitrary) number
of classes that we call “linker flavors”.</div></li><li><div class="item-name"><a class="enum" href="enum.LinkerFlavorCli.html" title="enum rustc_target::spec::LinkerFlavorCli">Linker<wbr>Flavor<wbr>Cli</a></div><div class="desc docblock-short">Linker flavors available externally through command line (<code>-Clinker-flavor</code>)
or json target specifications.
This set has accumulated historically, and contains both (stable and unstable) legacy values, as
well as modern ones matching the internal linker flavors (<code>LinkerFlavor</code>).</div></li><li><div class="item-name"><a class="enum" href="enum.Lld.html" title="enum rustc_target::spec::Lld">Lld</a></div><div class="desc docblock-short">Linker is LLD.</div></li><li><div class="item-name"><a class="enum" href="enum.LldFlavor.html" title="enum rustc_target::spec::LldFlavor">LldFlavor</a></div></li><li><div class="item-name"><a class="enum" href="enum.MergeFunctions.html" title="enum rustc_target::spec::MergeFunctions">Merge<wbr>Functions</a></div></li><li><div class="item-name"><a class="enum" href="enum.OnBrokenPipe.html" title="enum rustc_target::spec::OnBrokenPipe">OnBroken<wbr>Pipe</a></div></li><li><div class="item-name"><a class="enum" href="enum.PanicStrategy.html" title="enum rustc_target::spec::PanicStrategy">Panic<wbr>Strategy</a></div></li><li><div class="item-name"><a class="enum" href="enum.RelocModel.html" title="enum rustc_target::spec::RelocModel">Reloc<wbr>Model</a></div></li><li><div class="item-name"><a class="enum" href="enum.RelroLevel.html" title="enum rustc_target::spec::RelroLevel">Relro<wbr>Level</a></div></li><li><div class="item-name"><a class="enum" href="enum.SmallDataThresholdSupport.html" title="enum rustc_target::spec::SmallDataThresholdSupport">Small<wbr>Data<wbr>Threshold<wbr>Support</a></div></li><li><div class="item-name"><a class="enum" href="enum.SplitDebuginfo.html" title="enum rustc_target::spec::SplitDebuginfo">Split<wbr>Debuginfo</a></div></li><li><div class="item-name"><a class="enum" href="enum.StackProbeType.html" title="enum rustc_target::spec::StackProbeType">Stack<wbr>Probe<wbr>Type</a></div></li><li><div class="item-name"><a class="enum" href="enum.StackProtector.html" title="enum rustc_target::spec::StackProtector">Stack<wbr>Protector</a></div><div class="desc docblock-short">Controls use of stack canaries.</div></li><li><div class="item-name"><a class="enum" href="enum.SymbolVisibility.html" title="enum rustc_target::spec::SymbolVisibility">Symbol<wbr>Visibility</a></div></li><li><div class="item-name"><a class="enum" href="enum.TargetTriple.html" title="enum rustc_target::spec::TargetTriple">Target<wbr>Triple</a></div><div class="desc docblock-short">Either a target triple string or a path to a JSON file.</div></li><li><div class="item-name"><a class="enum" href="enum.TlsModel.html" title="enum rustc_target::spec::TlsModel">TlsModel</a></div></li><li><div class="item-name"><a class="enum" href="enum.WasmCAbi.html" title="enum rustc_target::spec::WasmCAbi">WasmC<wbr>Abi</a></div><div class="desc docblock-short">Which C ABI to use for <code>wasm32-unknown-unknown</code>.</div></li></ul><h2 id="constants" class="section-header">Constants<a href="#constants" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="constant" href="constant.TARGETS.html" title="constant rustc_target::spec::TARGETS">TARGETS</a></div><div class="desc docblock-short">List of supported targets</div></li></ul><h2 id="traits" class="section-header">Traits<a href="#traits" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="trait" href="trait.HasTargetSpec.html" title="trait rustc_target::spec::HasTargetSpec">HasTarget<wbr>Spec</a></div></li><li><div class="item-name"><a class="trait" href="trait.HasWasmCAbiOpt.html" title="trait rustc_target::spec::HasWasmCAbiOpt">HasWasmC<wbr>AbiOpt</a></div></li></ul><h2 id="functions" class="section-header">Functions<a href="#functions" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.add_link_args.html" title="fn rustc_target::spec::add_link_args">add_<wbr>link_<wbr>args</a><span title="Restricted Visibility">&nbsp;🔒</span> </div></li><li><div class="item-name"><a class="fn" href="fn.add_link_args_iter.html" title="fn rustc_target::spec::add_link_args_iter">add_<wbr>link_<wbr>args_<wbr>iter</a><span title="Restricted Visibility">&nbsp;🔒</span> </div><div class="desc docblock-short">Add arguments for the given flavor and also for its “twin” flavors
that have a compatible command line interface.</div></li><li><div class="item-name"><a class="fn" href="fn.current_apple_deployment_target.html" title="fn rustc_target::spec::current_apple_deployment_target">current_<wbr>apple_<wbr>deployment_<wbr>target</a></div><div class="desc docblock-short">Hack for calling <code>deployment_target</code> outside of this module.</div></li><li><div class="item-name"><a class="fn" href="fn.current_apple_platform.html" title="fn rustc_target::spec::current_apple_platform">current_<wbr>apple_<wbr>platform</a></div></li><li><div class="item-name"><a class="fn" href="fn.ef_avr_arch.html" title="fn rustc_target::spec::ef_avr_arch">ef_<wbr>avr_<wbr>arch</a></div><div class="desc docblock-short">Resolve the value of the EF_AVR_ARCH field for AVR ELF files, given the
name of the target CPU / MCU.</div></li><li><div class="item-name"><a class="fn" href="fn.load_builtin.html" title="fn rustc_target::spec::load_builtin">load_<wbr>builtin</a><span title="Restricted Visibility">&nbsp;🔒</span> </div></li></ul><h2 id="types" class="section-header">Type Aliases<a href="#types" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="type" href="type.LinkArgs.html" title="type rustc_target::spec::LinkArgs">Link<wbr>Args</a></div></li><li><div class="item-name"><a class="type" href="type.LinkArgsCli.html" title="type rustc_target::spec::LinkArgsCli">Link<wbr>Args<wbr>Cli</a></div></li><li><div class="item-name"><a class="type" href="type.StaticCow.html" title="type rustc_target::spec::StaticCow">Static<wbr>Cow</a><span title="Restricted Visibility">&nbsp;🔒</span> </div></li></ul></section></div></main></body></html>