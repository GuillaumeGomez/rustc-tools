<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Check the validity invariant of a given value, and tell the user where in the value it got violated. In const context, this goes even further and tries to approximate const safety. That’s useful because it means other passes (e.g. promotion) can rely on `const`s to be const-safe."><title>rustc_const_eval::interpret::validity - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-46f98efaafac5295.ttf.woff2,FiraSans-Regular-018c141bf0843ffd.woff2,FiraSans-Medium-8f9a781e4970d388.woff2,SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2,SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../../static.files/rustdoc-49344e4802b2d48a.css"><meta name="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="rustc_const_eval" data-themes="" data-resource-suffix="" data-rustdoc-version="1.83.0-dev" data-channel="nightly" data-search-js="search-e056c65ede92db13.js" data-settings-js="settings-805db61a62df4bd2.js" ><script src="../../../static.files/storage-1d39b6787ed640ff.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../../static.files/main-f070b9041d14864c.js"></script><noscript><link rel="stylesheet" href="../../../static.files/noscript-0111fcff984fae8f.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button><a class="logo-container" href="../../../rustc_const_eval/index.html"><img class="rust-logo" src="../../../static.files/rust-logo-151179464ae7ed46.svg" alt=""></a></nav><nav class="sidebar"><div class="sidebar-crate"><a class="logo-container" href="../../../rustc_const_eval/index.html"><img class="rust-logo" src="../../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2><a href="../../../rustc_const_eval/index.html">rustc_<wbr>const_<wbr>eval</a><span class="version">1.83.0-dev</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Module validity</a></h2><h3><a href="#macros">Module Items</a></h3><ul class="block"><li><a href="#macros" title="Macros">Macros</a></li><li><a href="#structs" title="Structs">Structs</a></li><li><a href="#enums" title="Enums">Enums</a></li><li><a href="#functions" title="Functions">Functions</a></li></ul></section><div id="rustdoc-modnav"><h2><a href="../index.html">In rustc_<wbr>const_<wbr>eval::<wbr>interpret</a></h2></div></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><span class="rustdoc-breadcrumbs"><a href="../../index.html">rustc_const_eval</a>::<wbr><a href="../index.html">interpret</a></span><h1>Module <span>validity</span><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../../src/rustc_const_eval/interpret/validity.rs.html#1-1457">source</a> </span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Check the validity invariant of a given value, and tell the user
where in the value it got violated.
In const context, this goes even further and tries to approximate const safety.
That’s useful because it means other passes (e.g. promotion) can rely on <code>const</code>s
to be const-safe.</p>
</div></details><h2 id="macros" class="section-header">Macros<a href="#macros" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="macro" href="macro.err_validation_failure.html" title="macro rustc_const_eval::interpret::validity::err_validation_failure">err_<wbr>validation_<wbr>failure</a><span title="Restricted Visibility">&nbsp;🔒</span> </div></li><li><div class="item-name"><a class="macro" href="macro.throw_validation_failure.html" title="macro rustc_const_eval::interpret::validity::throw_validation_failure">throw_<wbr>validation_<wbr>failure</a><span title="Restricted Visibility">&nbsp;🔒</span> </div></li><li><div class="item-name"><a class="macro" href="macro.try_validation.html" title="macro rustc_const_eval::interpret::validity::try_validation">try_<wbr>validation</a><span title="Restricted Visibility">&nbsp;🔒</span> </div><div class="desc docblock-short">If $e throws an error matching the pattern, throw a validation failure.
Other errors are passed back to the caller, unchanged – and if they reach the root of
the visitor, we make sure only validation errors and <code>InvalidProgram</code> errors are left.
This lets you use the patterns as a kind of validation list, asserting which errors
can possibly happen:</div></li></ul><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.RangeSet.html" title="struct rustc_const_eval::interpret::validity::RangeSet">Range<wbr>Set</a></div><div class="desc docblock-short">Represents a set of <code>Size</code> values as a sorted list of ranges.</div></li><li><div class="item-name"><a class="struct" href="struct.RefTracking.html" title="struct rustc_const_eval::interpret::validity::RefTracking">RefTracking</a></div><div class="desc docblock-short">State for tracking recursive validation of references</div></li><li><div class="item-name"><a class="struct" href="struct.ValidityVisitor.html" title="struct rustc_const_eval::interpret::validity::ValidityVisitor">Validity<wbr>Visitor</a><span title="Restricted Visibility">&nbsp;🔒</span> </div></li></ul><h2 id="enums" class="section-header">Enums<a href="#enums" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="enum" href="enum.CtfeValidationMode.html" title="enum rustc_const_eval::interpret::validity::CtfeValidationMode">Ctfe<wbr>Validation<wbr>Mode</a></div><div class="desc docblock-short">Extra things to check for during validation of CTFE results.</div></li><li><div class="item-name"><a class="enum" href="enum.PathElem.html" title="enum rustc_const_eval::interpret::validity::PathElem">Path<wbr>Elem</a></div><div class="desc docblock-short">We want to show a nice path to the invalid field for diagnostics,
but avoid string operations in the happy case where no error happens.
So we track a <code>Vec&lt;PathElem&gt;</code> where <code>PathElem</code> contains all the data we
need to later print something for the user.</div></li></ul><h2 id="functions" class="section-header">Functions<a href="#functions" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.mutability.html" title="fn rustc_const_eval::interpret::validity::mutability">mutability</a><span title="Restricted Visibility">&nbsp;🔒</span> </div><div class="desc docblock-short">Returns whether the allocation is mutable, and whether it’s actually a static.
For “root” statics we look at the type to account for interior
mutability; for nested statics we have no type and directly use the annotated mutability.</div></li><li><div class="item-name"><a class="fn" href="fn.write_path.html" title="fn rustc_const_eval::interpret::validity::write_path">write_<wbr>path</a><span title="Restricted Visibility">&nbsp;🔒</span> </div><div class="desc docblock-short">Format a path</div></li></ul></section></div></main></body></html>